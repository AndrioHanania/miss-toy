import{j as e,r as b,u as f,a as S,t as k,L as g,b as p,c as T,O as C,o as y,s as v,d as F}from"./index-J8qZg7lB.js";import{s as N,u as L,a as $,L as w,l as M,r as O}from"./Loader-DFRxibOx.js";function _({isChecked:s,onChange:c,label1:l="ON",label2:r="OFF",id:d=`toggle-${l}`,name:i=`toggle-${l}`}){return e.jsxs("div",{className:"toggle-container",children:[e.jsxs("label",{htmlFor:d,className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:c,id:d,name:i}),e.jsx("span",{className:"slider"})]}),e.jsx("span",{children:s?l:r})]})}function A({filterBy:s,onSetFilter:c}){const[l,r]=b.useState({...s}),d=b.useRef(f.debounce(c));S(()=>{d.current(l)},[l]);function i({target:t}){const j=t.name;let m=t.value;switch(t.type){case"number":case"range":m=+m||"";break;case"checkbox":m=t.checked;break}r({...l,[j]:m})}function x(t){const j=Array.from(t.target.selectedOptions).map(m=>m.value);r(m=>({...m,labels:j}))}const{name:n,price:h,priceSort:o,labels:u,statusStock:a}=l;return e.jsxs("section",{className:"toy-filter",children:[e.jsx("h2",{children:"Filter Tody"}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{value:n,onChange:i,type:"search",id:"name",name:"name"})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"price",children:"Price"}),e.jsx("input",{onChange:i,value:h,type:"number",id:"price",name:"price",min:0}),e.jsx(_,{onChange:i,isChecked:o,id:"priceSort",name:"priceSort",label1:"Below",label2:"Above"})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"labels",children:"Labels"}),e.jsxs("select",{onChange:x,value:u,id:"labels",name:"labels",size:5,className:"labels-select",multiple:!0,children:[e.jsx("option",{value:"",children:"Choose a Label"}),k.getLabels().map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"statusStock",children:"Status Stock: "}),e.jsxs("select",{id:"statusStock",name:"statusStock",value:a,onChange:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"IN_STOCK",children:"In Stock"}),e.jsx("option",{value:"NOT_IN_STOCK",children:"Out of Stock"})]})]})]})]})}function E({toy:s}){return e.jsx("article",{children:e.jsxs(g,{to:`/toy/${s._id}`,className:"toy-preview",children:[e.jsx("h2",{children:s.name}),e.jsx("h4",{children:s.price}),e.jsx("img",{className:"toy-img",src:s.imageUrl,alt:s.txt}),s.inStock&&e.jsx("img",{className:"in-stock",src:"/plus-icon.svg",alt:"in stock"})]})})}function z({toys:s,onRemoveToy:c,isLoggedinUserAdmin:l}){return e.jsxs("ul",{className:"toy-list",children:[e.jsx("li",{className:"add-toy",children:e.jsx(g,{to:"/toy/edit",children:e.jsx("img",{src:"/plus-icon.svg",alt:"add toy"})})},"add-toy"),s.map(r=>e.jsxs("li",{children:[e.jsx(E,{toy:r}),l&&e.jsxs("section",{className:"admin-dashboard",children:[e.jsx("button",{onClick:()=>c(r._id),children:"Remove"}),e.jsx("button",{children:e.jsx(g,{to:`/toy/edit/${r._id}`,children:"Edit"})})]})]},r._id))]})}const B=({pagination:s,totalPages:c,onChangePage:l,onChangePageSize:r})=>{const d=s.page<=1,i=s.page>=c;if(!s||!c)return null;function x(){const n=c-s.page+1;return c<=3?[...Array(n)].map((h,o)=>e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===o+s.page?"active":""}`,onClick:()=>l(o+s.page),children:o+s.page})},`page-number-${o+s.page}`)):[[...Array(3)].map((h,o)=>{const u=o+1+3*Math.floor(o/3);return e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===u?"active":""}`,onClick:()=>l(u),children:u})},`page-number-${u}`)}),e.jsx("li",{className:"page-number ellipsis",children:"..."},"ellipsis"),e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===c?"active":""}`,onClick:()=>l(c),children:c})},`page-number-${c}`)]}return e.jsxs("div",{className:"pagination-container",children:[e.jsxs("div",{className:"pagination-panel",children:[e.jsx("button",{className:`${d?"disabled":""}`,disabled:d,onClick:()=>l(s.page-1),children:"←"}),e.jsx("ul",{className:"page-numbers",children:e.jsx(x,{total:c-s.page+1})}),e.jsx("button",{className:`${i?"disabled":""}`,disabled:i,onClick:()=>l(s.page+1),children:"→"})]}),e.jsxs("div",{className:"pagination-controller",children:[e.jsxs("span",{children:["Page: ",s.page]}),e.jsx("ul",{className:"page-sizes",children:[5,10,15,20].map((n,h)=>e.jsx("li",{className:"page-size",children:e.jsx("button",{className:`${s.pageSize===n?"active":""}`,onClick:()=>r(n),children:n})},`page-size-${h}`))})]})]})};function D(){const s=p(a=>a.toyModule.toys),c=p(a=>a.toyModule.pages),l=p(a=>a.toyModule.filterBy),r=p(a=>a.toyModule.isLoading),[d,i]=T(),x=k.getFilterFromSearchParams(d),n=p(a=>a.userModule.user),h=n==null?void 0:n.isAdmin;b.useEffect(()=>{N(x)},[]),S(()=>{i(f.getTruthyValues(l));try{M(l)}catch{v("Could not load toys")}},[l]);function o({toyId:a}){return e.jsxs("section",{children:[e.jsxs("p",{children:["Are you sure you want to delete  toy with id of ",a,"?"]}),e.jsx("button",{onClick:async()=>{y(null);try{await O(a),F("Toy removed")}catch{console.log("err:",err),v("Cannot remove toy "+a)}},children:"Yes"})]})}async function u(a){y({cmp:o,props:{toyId:a},style:{border:"5px solid red"}})}return e.jsxs("section",{className:"toy-index",children:[e.jsx(A,{filterBy:l,onSetFilter:N}),e.jsx("h2",{children:"Toys List"}),!r&&e.jsxs("div",{children:[e.jsx(z,{toys:s,onRemoveToy:u,isLoggedinUserAdmin:h}),e.jsx(B,{pagination:l.pagination,totalPages:c,onChangePageSize:L,onChangePage:$})]}),e.jsx(C,{}),e.jsx(w,{isLoading:r,text:"Loading toys..."})]})}export{D as default};
