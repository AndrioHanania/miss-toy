import{j as e,r as p,u as f,a as S,t as k,L as b,b as x,c as T,s as y,O as C,o as v,d as F}from"./index-B5y-NNBZ.js";import{s as N,l as L,u as $,a as w,L as M,r as O}from"./Loader-pO6B7iiP.js";function E({isChecked:s,onChange:c,label1:a="ON",label2:r="OFF",id:o=`toggle-${a}`,name:i=`toggle-${a}`}){return e.jsxs("div",{className:"toggle-container",children:[e.jsxs("label",{htmlFor:o,className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:c,id:o,name:i}),e.jsx("span",{className:"slider"})]}),e.jsx("span",{children:s?a:r})]})}function _({filterBy:s,onSetFilter:c}){const[a,r]=p.useState({...s}),o=p.useRef(f.debounce(c));S(()=>{o.current(a)},[a]);function i({target:t}){const j=t.name;let u=t.value;switch(t.type){case"number":case"range":u=+u||"";break;case"checkbox":u=t.checked;break}r({...a,[j]:u})}function m(t){const j=Array.from(t.target.selectedOptions).map(u=>u.value);r(u=>({...u,labels:j}))}const{name:d,price:h,priceSort:n,labels:l,statusStock:g}=a;return e.jsxs("section",{className:"toy-filter",children:[e.jsx("h2",{children:"Filter Tody"}),e.jsxs("form",{onSubmit:t=>t.preventDefault(),children:[e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{value:d,onChange:i,type:"search",id:"name",name:"name"})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"price",children:"Price"}),e.jsx("input",{onChange:i,value:h,type:"number",id:"price",name:"price",min:0}),e.jsx(E,{onChange:i,isChecked:n,id:"priceSort",name:"priceSort",label1:"Below",label2:"Above"})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"labels",children:"Labels"}),e.jsxs("select",{onChange:m,value:l,id:"labels",name:"labels",size:5,className:"labels-select",multiple:!0,children:[e.jsx("option",{disabled:!0,value:"",children:"Choose a Label"}),k.getLabels().map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"label-input-form",children:[e.jsx("label",{htmlFor:"statusStock",children:"Status Stock: "}),e.jsxs("select",{id:"statusStock",name:"statusStock",value:g,onChange:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"IN_STOCK",children:"In Stock"}),e.jsx("option",{value:"NOT_IN_STOCK",children:"Out of Stock"})]})]})]})]})}function A({toy:s}){return e.jsx("article",{children:e.jsxs(b,{to:`/toy/${s._id}`,className:"toy-preview",children:[e.jsx("h2",{children:s.name}),e.jsx("h4",{children:s.price}),e.jsx("img",{className:"toy-img",src:s.imageUrl,alt:s.txt}),s.inStock&&e.jsx("img",{className:"in-stock",src:"/miss-toy/in-stock.png",alt:"in stock"})]})})}function z({toys:s,onRemoveToy:c,isLoggedinUserAdmin:a}){return e.jsxs("ul",{className:"toy-list",children:[e.jsx("li",{className:"add-toy",children:e.jsx(b,{to:"/toy/edit",children:e.jsx("img",{src:"/miss-toy/plus-icon.svg",alt:"add toy"})})},"add-toy"),s.map(r=>e.jsxs("li",{children:[e.jsx(A,{toy:r}),a&&e.jsxs("section",{className:"admin-dashboard",children:[e.jsx("button",{onClick:()=>c(r._id),children:"Remove"}),e.jsx("button",{children:e.jsx(b,{to:`/toy/edit/${r._id}`,children:"Edit"})})]})]},r._id))]})}const B=({pagination:s,totalPages:c,onChangePage:a,onChangePageSize:r})=>{const o=s.page<=1,i=s.page>=c;if(!s||!c)return null;function m(){const d=c-s.page+1;return c<=3?[...Array(d)].map((h,n)=>e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===n+s.page?"active":""}`,onClick:()=>a(n+s.page),children:n+s.page})},`page-number-${n+s.page}`)):[[...Array(3)].map((h,n)=>{const l=n+1+3*Math.floor(n/3);return e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===l?"active":""}`,onClick:()=>a(l),children:l})},`page-number-${l}`)}),e.jsx("li",{className:"page-number ellipsis",children:"..."},"ellipsis"),e.jsx("li",{className:"page-number",children:e.jsx("button",{className:`${s.page===c?"active":""}`,onClick:()=>a(c),children:c})},`page-number-${c}`)]}return e.jsxs("div",{className:"pagination-container",children:[e.jsxs("div",{className:"pagination-panel",children:[e.jsx("button",{className:`${o?"disabled":""}`,disabled:o,onClick:()=>a(s.page-1),children:"←"}),e.jsx("ul",{className:"page-numbers",children:e.jsx(m,{total:c-s.page+1})}),e.jsx("button",{className:`${i?"disabled":""}`,disabled:i,onClick:()=>a(s.page+1),children:"→"})]}),e.jsxs("div",{className:"pagination-controller",children:[e.jsxs("span",{children:["Page: ",s.page]}),e.jsx("ul",{className:"page-sizes",children:[5,10,15,20].map((d,h)=>e.jsx("li",{className:"page-size",children:e.jsx("button",{className:`${s.pageSize===d?"active":""}`,onClick:()=>r(d),children:d})},`page-size-${h}`))})]})]})};function D(){const s=x(l=>l.toyModule.toys),c=x(l=>l.toyModule.pages),a=x(l=>l.toyModule.filterBy),r=x(l=>l.toyModule.isLoading),[o,i]=T(),m=x(l=>l.userModule.user),d=m==null?void 0:m.isAdmin;p.useEffect(()=>{const l=k.getFilterFromSearchParams(o);N(l)},[]),S(()=>{i(f.getTruthyValues(a))},[a]),p.useEffect(()=>{try{L()}catch{console.eror("err:",err),y("Cannot load toys")}},[o]);function h({toyId:l}){return e.jsxs("section",{children:[e.jsxs("p",{children:["Are you sure you want to delete  toy with id of ",l,"?"]}),e.jsx("button",{onClick:async()=>{v(null);try{await O(l),F("Toy removed")}catch{console.log("err:",err),y("Cannot remove toy "+l)}},children:"Yes"})]})}async function n(l){v({cmp:h,props:{toyId:l},style:{border:"5px solid red"}})}return e.jsxs("section",{className:"toy-index",children:[e.jsx(_,{filterBy:a,onSetFilter:N}),e.jsx("h2",{children:"Toys List"}),!r&&e.jsxs("div",{children:[e.jsx(z,{toys:s,onRemoveToy:n,isLoggedinUserAdmin:d}),e.jsx(B,{pagination:a.pagination,totalPages:c,onChangePageSize:$,onChangePage:w})]}),e.jsx(C,{}),e.jsx(M,{isLoading:r,text:"Loading toys..."})]})}export{D as default};
